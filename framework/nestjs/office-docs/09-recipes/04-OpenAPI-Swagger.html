<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenAPI（Swagger） | NodeJS</title>
    <meta name="description" content="Learn Cookbook">
    
    
    <link rel="preload" href="/assets/css/0.styles.34788bb2.css" as="style"><link rel="preload" href="/assets/js/app.12ca0aa8.js" as="script"><link rel="preload" href="/assets/js/2.74bffc86.js" as="script"><link rel="preload" href="/assets/js/108.d0fceeff.js" as="script"><link rel="prefetch" href="/assets/js/10.b17cd786.js"><link rel="prefetch" href="/assets/js/100.49143f76.js"><link rel="prefetch" href="/assets/js/101.58f5e966.js"><link rel="prefetch" href="/assets/js/102.0d1b5f3c.js"><link rel="prefetch" href="/assets/js/103.d2dfeb4d.js"><link rel="prefetch" href="/assets/js/104.221dfde0.js"><link rel="prefetch" href="/assets/js/105.89693a0d.js"><link rel="prefetch" href="/assets/js/106.dd9b2874.js"><link rel="prefetch" href="/assets/js/107.b128334b.js"><link rel="prefetch" href="/assets/js/109.a36abbdb.js"><link rel="prefetch" href="/assets/js/11.3a5bf6a3.js"><link rel="prefetch" href="/assets/js/110.24de8f58.js"><link rel="prefetch" href="/assets/js/111.ad2322c5.js"><link rel="prefetch" href="/assets/js/112.ebf5a5e6.js"><link rel="prefetch" href="/assets/js/113.945153eb.js"><link rel="prefetch" href="/assets/js/114.89fb0b54.js"><link rel="prefetch" href="/assets/js/115.32747b75.js"><link rel="prefetch" href="/assets/js/116.2ac5709d.js"><link rel="prefetch" href="/assets/js/117.33f44883.js"><link rel="prefetch" href="/assets/js/118.080ca422.js"><link rel="prefetch" href="/assets/js/119.3696781e.js"><link rel="prefetch" href="/assets/js/12.49c205ea.js"><link rel="prefetch" href="/assets/js/120.8629050e.js"><link rel="prefetch" href="/assets/js/121.c541c819.js"><link rel="prefetch" href="/assets/js/122.0beeab62.js"><link rel="prefetch" href="/assets/js/123.f4aacc83.js"><link rel="prefetch" href="/assets/js/124.7b0ddfcc.js"><link rel="prefetch" href="/assets/js/125.b8173440.js"><link rel="prefetch" href="/assets/js/126.9ee9486f.js"><link rel="prefetch" href="/assets/js/127.6c6aee84.js"><link rel="prefetch" href="/assets/js/128.8100734d.js"><link rel="prefetch" href="/assets/js/129.adb74c9f.js"><link rel="prefetch" href="/assets/js/13.b12048d4.js"><link rel="prefetch" href="/assets/js/130.7dbfe596.js"><link rel="prefetch" href="/assets/js/131.a32c075c.js"><link rel="prefetch" href="/assets/js/132.6a0aa273.js"><link rel="prefetch" href="/assets/js/133.52f806e2.js"><link rel="prefetch" href="/assets/js/134.a196478b.js"><link rel="prefetch" href="/assets/js/135.83dc683e.js"><link rel="prefetch" href="/assets/js/136.e31ffd18.js"><link rel="prefetch" href="/assets/js/137.c9dbde0b.js"><link rel="prefetch" href="/assets/js/138.4d1cd5eb.js"><link rel="prefetch" href="/assets/js/139.432cf5af.js"><link rel="prefetch" href="/assets/js/14.daaf0416.js"><link rel="prefetch" href="/assets/js/140.f86409f6.js"><link rel="prefetch" href="/assets/js/141.3abe86ad.js"><link rel="prefetch" href="/assets/js/142.4f6fc92f.js"><link rel="prefetch" href="/assets/js/143.1535cab9.js"><link rel="prefetch" href="/assets/js/144.eefe99f6.js"><link rel="prefetch" href="/assets/js/145.0a2bc4ed.js"><link rel="prefetch" href="/assets/js/146.0e7b17e8.js"><link rel="prefetch" href="/assets/js/147.aecc5e52.js"><link rel="prefetch" href="/assets/js/148.55697156.js"><link rel="prefetch" href="/assets/js/149.78d2096d.js"><link rel="prefetch" href="/assets/js/15.45e9a802.js"><link rel="prefetch" href="/assets/js/150.e6c87191.js"><link rel="prefetch" href="/assets/js/151.a8009d6e.js"><link rel="prefetch" href="/assets/js/152.63d8fdec.js"><link rel="prefetch" href="/assets/js/153.3bfc0798.js"><link rel="prefetch" href="/assets/js/154.65d2ca87.js"><link rel="prefetch" href="/assets/js/155.6eeb8114.js"><link rel="prefetch" href="/assets/js/156.651636fd.js"><link rel="prefetch" href="/assets/js/157.91eccdc2.js"><link rel="prefetch" href="/assets/js/158.dbf5b9d8.js"><link rel="prefetch" href="/assets/js/159.823f0880.js"><link rel="prefetch" href="/assets/js/16.e71df8d4.js"><link rel="prefetch" href="/assets/js/160.cfed749a.js"><link rel="prefetch" href="/assets/js/161.84daf4cb.js"><link rel="prefetch" href="/assets/js/162.ceb37edb.js"><link rel="prefetch" href="/assets/js/163.d225972f.js"><link rel="prefetch" href="/assets/js/164.74f77e4a.js"><link rel="prefetch" href="/assets/js/165.e158fe5d.js"><link rel="prefetch" href="/assets/js/166.c41de610.js"><link rel="prefetch" href="/assets/js/167.7df65d3f.js"><link rel="prefetch" href="/assets/js/168.919437c8.js"><link rel="prefetch" href="/assets/js/169.9bcafe9d.js"><link rel="prefetch" href="/assets/js/17.7dc7c03f.js"><link rel="prefetch" href="/assets/js/170.f33f16fb.js"><link rel="prefetch" href="/assets/js/171.59cd7a83.js"><link rel="prefetch" href="/assets/js/172.e059a6f4.js"><link rel="prefetch" href="/assets/js/173.811a1b3e.js"><link rel="prefetch" href="/assets/js/174.e8d72986.js"><link rel="prefetch" href="/assets/js/175.3ee31f58.js"><link rel="prefetch" href="/assets/js/176.437ff1a6.js"><link rel="prefetch" href="/assets/js/177.0d04f570.js"><link rel="prefetch" href="/assets/js/178.45296cb6.js"><link rel="prefetch" href="/assets/js/179.4176b858.js"><link rel="prefetch" href="/assets/js/18.7d64b721.js"><link rel="prefetch" href="/assets/js/180.a2c20ea9.js"><link rel="prefetch" href="/assets/js/181.77390ab1.js"><link rel="prefetch" href="/assets/js/182.8ebcfdac.js"><link rel="prefetch" href="/assets/js/183.8a6b9bc8.js"><link rel="prefetch" href="/assets/js/184.a8587cd6.js"><link rel="prefetch" href="/assets/js/185.763d219b.js"><link rel="prefetch" href="/assets/js/186.d1c67c82.js"><link rel="prefetch" href="/assets/js/187.d0379152.js"><link rel="prefetch" href="/assets/js/188.3935a5a7.js"><link rel="prefetch" href="/assets/js/189.d40e35ad.js"><link rel="prefetch" href="/assets/js/19.1f322990.js"><link rel="prefetch" href="/assets/js/190.f5168c2b.js"><link rel="prefetch" href="/assets/js/191.00fd22a9.js"><link rel="prefetch" href="/assets/js/192.bb76bc33.js"><link rel="prefetch" href="/assets/js/193.0028d6ac.js"><link rel="prefetch" href="/assets/js/194.504c913a.js"><link rel="prefetch" href="/assets/js/195.6d91833a.js"><link rel="prefetch" href="/assets/js/20.520e4112.js"><link rel="prefetch" href="/assets/js/21.1da5f168.js"><link rel="prefetch" href="/assets/js/22.d42c6e1f.js"><link rel="prefetch" href="/assets/js/23.158333f0.js"><link rel="prefetch" href="/assets/js/24.4933f40a.js"><link rel="prefetch" href="/assets/js/25.057c428c.js"><link rel="prefetch" href="/assets/js/26.de289859.js"><link rel="prefetch" href="/assets/js/27.b14ef5da.js"><link rel="prefetch" href="/assets/js/28.b1329e69.js"><link rel="prefetch" href="/assets/js/29.49d46c7a.js"><link rel="prefetch" href="/assets/js/3.9fae61cb.js"><link rel="prefetch" href="/assets/js/30.83d321ec.js"><link rel="prefetch" href="/assets/js/31.65f56091.js"><link rel="prefetch" href="/assets/js/32.78fcc539.js"><link rel="prefetch" href="/assets/js/33.87e5077b.js"><link rel="prefetch" href="/assets/js/34.a4bf065f.js"><link rel="prefetch" href="/assets/js/35.b81d32e6.js"><link rel="prefetch" href="/assets/js/36.9ef245a6.js"><link rel="prefetch" href="/assets/js/37.4e2664a6.js"><link rel="prefetch" href="/assets/js/38.f8b21767.js"><link rel="prefetch" href="/assets/js/39.294b2e23.js"><link rel="prefetch" href="/assets/js/4.554dccb8.js"><link rel="prefetch" href="/assets/js/40.a35c8bd3.js"><link rel="prefetch" href="/assets/js/41.d60f7eb3.js"><link rel="prefetch" href="/assets/js/42.30f5ce46.js"><link rel="prefetch" href="/assets/js/43.101904fa.js"><link rel="prefetch" href="/assets/js/44.475772ec.js"><link rel="prefetch" href="/assets/js/45.58a6227c.js"><link rel="prefetch" href="/assets/js/46.045cad94.js"><link rel="prefetch" href="/assets/js/47.63628bb5.js"><link rel="prefetch" href="/assets/js/48.4f86f4a6.js"><link rel="prefetch" href="/assets/js/49.92a2af24.js"><link rel="prefetch" href="/assets/js/5.bfcb02d1.js"><link rel="prefetch" href="/assets/js/50.b7fd8454.js"><link rel="prefetch" href="/assets/js/51.9bbf3588.js"><link rel="prefetch" href="/assets/js/52.53f6da60.js"><link rel="prefetch" href="/assets/js/53.b415231c.js"><link rel="prefetch" href="/assets/js/54.53388fc4.js"><link rel="prefetch" href="/assets/js/55.fc24bc21.js"><link rel="prefetch" href="/assets/js/56.9b3c2535.js"><link rel="prefetch" href="/assets/js/57.ba13dd55.js"><link rel="prefetch" href="/assets/js/58.9a4c6a43.js"><link rel="prefetch" href="/assets/js/59.96e435e7.js"><link rel="prefetch" href="/assets/js/6.95fccca8.js"><link rel="prefetch" href="/assets/js/60.d17a46b6.js"><link rel="prefetch" href="/assets/js/61.0860ef3f.js"><link rel="prefetch" href="/assets/js/62.713860bc.js"><link rel="prefetch" href="/assets/js/63.38e7edcf.js"><link rel="prefetch" href="/assets/js/64.176f8bbb.js"><link rel="prefetch" href="/assets/js/65.903f4b50.js"><link rel="prefetch" href="/assets/js/66.1c5277a5.js"><link rel="prefetch" href="/assets/js/67.abfce232.js"><link rel="prefetch" href="/assets/js/68.37814697.js"><link rel="prefetch" href="/assets/js/69.c77c3c67.js"><link rel="prefetch" href="/assets/js/7.d035404c.js"><link rel="prefetch" href="/assets/js/70.742159c8.js"><link rel="prefetch" href="/assets/js/71.00f8f464.js"><link rel="prefetch" href="/assets/js/72.c8145491.js"><link rel="prefetch" href="/assets/js/73.edd94acd.js"><link rel="prefetch" href="/assets/js/74.deb52f36.js"><link rel="prefetch" href="/assets/js/75.5969aaa2.js"><link rel="prefetch" href="/assets/js/76.24433b28.js"><link rel="prefetch" href="/assets/js/77.e1a029bc.js"><link rel="prefetch" href="/assets/js/78.ec41973a.js"><link rel="prefetch" href="/assets/js/79.a8436b64.js"><link rel="prefetch" href="/assets/js/8.d1c35f37.js"><link rel="prefetch" href="/assets/js/80.70d752cd.js"><link rel="prefetch" href="/assets/js/81.5392aaa4.js"><link rel="prefetch" href="/assets/js/82.87f6938e.js"><link rel="prefetch" href="/assets/js/83.9efaf755.js"><link rel="prefetch" href="/assets/js/84.d0bba92a.js"><link rel="prefetch" href="/assets/js/85.f8f968c5.js"><link rel="prefetch" href="/assets/js/86.9e5296f6.js"><link rel="prefetch" href="/assets/js/87.8774d4bd.js"><link rel="prefetch" href="/assets/js/88.7513e6b5.js"><link rel="prefetch" href="/assets/js/89.421b5237.js"><link rel="prefetch" href="/assets/js/9.220b3eb6.js"><link rel="prefetch" href="/assets/js/90.47497ac9.js"><link rel="prefetch" href="/assets/js/91.20e7b656.js"><link rel="prefetch" href="/assets/js/92.ab742aa0.js"><link rel="prefetch" href="/assets/js/93.6f6eef2e.js"><link rel="prefetch" href="/assets/js/94.b8ff20d8.js"><link rel="prefetch" href="/assets/js/95.e97d80de.js"><link rel="prefetch" href="/assets/js/96.7f9bfe96.js"><link rel="prefetch" href="/assets/js/97.5bc5b95e.js"><link rel="prefetch" href="/assets/js/98.07280354.js"><link rel="prefetch" href="/assets/js/99.be9ded95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.34788bb2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NodeJS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/core/" class="nav-link">Node</a></div><div class="nav-item"><a href="/packageManager/" class="nav-link">Manager</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Nestjs" class="dropdown-title"><span class="title">Nestjs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/nestjs/office-docs/" class="nav-link router-link-active">NestJS 官方文档</a></li><li class="dropdown-item"><!----> <a href="/nestjs/source-codes/" class="nav-link">NestJS 源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="framework" class="dropdown-title"><span class="title">framework</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/egg/" class="nav-link">egg</a></li><li class="dropdown-item"><!----> <a href="/framework/express/" class="nav-link">express</a></li><li class="dropdown-item"><!----> <a href="/framework/fasitify/" class="nav-link">fasitify</a></li><li class="dropdown-item"><!----> <a href="/framework/hapi/" class="nav-link">hapi</a></li><li class="dropdown-item"><!----> <a href="/framework/koa/" class="nav-link">koa</a></li><li class="dropdown-item"><!----> <a href="/framework/midway/" class="nav-link">midway</a></li></ul></div></div><div class="nav-item"><a href="/graphql/" class="nav-link">graphql</a></div><div class="nav-item"><a href="/TypeORM/" class="nav-link">TypeORM</a></div><div class="nav-item"><a href="/branchmark/" class="nav-link">性能</a></div><div class="nav-item"><a href="/vendor/" class="nav-link">第三方包</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/core/" class="nav-link">Node</a></div><div class="nav-item"><a href="/packageManager/" class="nav-link">Manager</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Nestjs" class="dropdown-title"><span class="title">Nestjs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/nestjs/office-docs/" class="nav-link router-link-active">NestJS 官方文档</a></li><li class="dropdown-item"><!----> <a href="/nestjs/source-codes/" class="nav-link">NestJS 源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="framework" class="dropdown-title"><span class="title">framework</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/egg/" class="nav-link">egg</a></li><li class="dropdown-item"><!----> <a href="/framework/express/" class="nav-link">express</a></li><li class="dropdown-item"><!----> <a href="/framework/fasitify/" class="nav-link">fasitify</a></li><li class="dropdown-item"><!----> <a href="/framework/hapi/" class="nav-link">hapi</a></li><li class="dropdown-item"><!----> <a href="/framework/koa/" class="nav-link">koa</a></li><li class="dropdown-item"><!----> <a href="/framework/midway/" class="nav-link">midway</a></li></ul></div></div><div class="nav-item"><a href="/graphql/" class="nav-link">graphql</a></div><div class="nav-item"><a href="/TypeORM/" class="nav-link">TypeORM</a></div><div class="nav-item"><a href="/branchmark/" class="nav-link">性能</a></div><div class="nav-item"><a href="/vendor/" class="nav-link">第三方包</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总览-OVERVIEW</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基本原理 - Fundamentals</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术技巧 - Techniques</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Graphql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web 套接字</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>单 App</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>脚手架 CLI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>食谱 Recipes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/nestjs/office-docs/09-recipes/01-typeORM.html" class="sidebar-link">SQL（TypeORM）</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/02-mongoose.html" class="sidebar-link">MongoDB（猫鼬）</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/03-sequelize.html" class="sidebar-link">SQL（序列化）</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html" class="active sidebar-link">OpenAPI（Swagger）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#引导程序" class="sidebar-link">引导程序</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#路由参数" class="sidebar-link">路由参数</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#枚举" class="sidebar-link">枚举</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#枚举架构" class="sidebar-link">枚举架构</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#依赖循环" class="sidebar-link">依赖循环</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#泛型和接口" class="sidebar-link">泛型和接口</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#原始定义" class="sidebar-link">原始定义</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#额外的模型" class="sidebar-link">额外的模型</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#oneof，anyof，allof" class="sidebar-link">oneOf，anyOf，allOf</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#多种规格" class="sidebar-link">多种规格</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#标签" class="sidebar-link">标签</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#标头" class="sidebar-link">标头</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#回应" class="sidebar-link">回应</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#全局设置" class="sidebar-link">全局设置</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#安全" class="sidebar-link">安全</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#基本身份验证" class="sidebar-link">基本身份验证</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#承载认证" class="sidebar-link">承载认证</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#oauth2身份验证" class="sidebar-link">OAuth2身份验证</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#文件上传" class="sidebar-link">文件上传</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#扩展" class="sidebar-link">扩展</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#装饰" class="sidebar-link">装饰</a></li><li class="sidebar-sub-header"><a href="/framework/nestjs/office-docs/09-recipes/04-OpenAPI-Swagger.html#插件" class="sidebar-link">插件</a></li></ul></li><li><a href="/framework/nestjs/office-docs/09-recipes/05-CQRS.html" class="sidebar-link">CQRS</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/06-prisma.html" class="sidebar-link">棱柱 Prisma</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/07-healthChecks-terminus.html" class="sidebar-link">健康检查 Health checks(Terminus)</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/08-documentation.html" class="sidebar-link">文献资料</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/09-hot-reload.html" class="sidebar-link">模块热加载</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/10-serveStatic.html" class="sidebar-link">静态服务</a></li><li><a href="/framework/nestjs/office-docs/09-recipes/CRUD-utilities.html" class="sidebar-link">/framework/nestjs/office-docs/09-recipes/CRUD-utilities.html</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FQA</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="openapi（swagger）"><a href="#openapi（swagger）" class="header-anchor">#</a> OpenAPI（Swagger）</h1> <p>该OpenAPI的规范是用来描述RESTful API中语言无关的高清格式。Nest提供了一个专用模块，该模块允许利用装饰器生成此类规范。</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>要开始使用它，我们首先安装所需的依赖项。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> --save @nestjs/swagger swagger-ui-express
</code></pre></div><p>如果使用fastify，请安装fastify-swagger而不是swagger-ui-express：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">npm</span> <span class="token function">install</span> --save @nestjs/swagger fastify-swagger
</code></pre></div><h2 id="引导程序"><a href="#引导程序" class="header-anchor">#</a> 引导程序</h2> <p>安装过程完成后，打开main.ts文件并使用以下SwaggerModule类初始化Swagger ：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SwaggerModule<span class="token punctuation">,</span> DocumentBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/swagger'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app.module'</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">'Cats example'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">'The cats API description'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setVersion</span><span class="token punctuation">(</span><span class="token string">'1.0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addTag</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> document <span class="token operator">=</span> SwaggerModule<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  SwaggerModule<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> app<span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将DocumentBuilder有助于构建一个基础文档符合该规格的OpenAPI。它提供了几种方法，可以设置诸如标题，描述，版本等属性。为了创建完整的文档（定义了所有HTTP路由），我们使用该类的createDocument()方法SwaggerModule。此方法带有两个参数，一个应用程序实例和一个Swagger选项对象。</p> <p>创建文档后，就可以调用setup()method了。它接受：</p> <ol><li>Swagger UI的安装路径</li> <li>一个应用程序实例</li> <li>上面实例化的文档对象</li></ol> <p>现在，您可以运行以下命令来启动HTTP服务器：</p> <p>在应用程序运行时，打开浏览器并导航至http://localhost:3000/api。您应该看到Swagger UI。</p> <p>该SwaggerModule自动反映您的所有端点。另外，为了显示Swagger UI，请@nestjs/swagger使用swagger-ui-express或fastify-swagger取决于平台。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
要生成和下载Swagger JSON文件，请http://localhost:3000/api-json在浏览器中导航到（假设您的Swagger文档在下http://localhost:3000/api）。</p></div> <h2 id="路由参数"><a href="#路由参数" class="header-anchor">#</a> 路由参数</h2> <p>在SwaggerModule所有的搜索@Body()，@Query()以及@Param()在路由执行装饰器来生成API文档。它还利用反射来创建相应的模型定义。考虑以下代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
要显式设置主体定义，请使用@ApiBody()装饰器（@nestjs/swagger包）。</p></div> <p>基于CreateCatDto，将创建模块定义：</p> <p>如您所见，尽管类具有一些声明的属性，但定义为空。为了使类属性对可见SwaggerModule，我们必须@ApiProperty()使用装饰器为它们添加注释，或使用CLI插件（请在“ 插件”部分中了解更多信息），该插件将自动执行此操作：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ApiProperty <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/swagger'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span>
  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
考虑使用Swagger插件（请参阅“ 插件”部分），它将自动为您完成此操作。</p></div> <p>让我们打开浏览器并验证生成的CreateCatDto模型：</p> <p>另外，@ApiProperty()装饰器允许设置各种模式对象属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  description<span class="token operator">:</span> <span class="token string">'The age of a cat'</span><span class="token punctuation">,</span>
  minimum<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
无需显式键入，@ApiProperty({ required: false })您可以使用@ApiPropertyOptional()简写修饰符。</p></div> <p>为了显式设置属性的类型，请使用type键：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="枚举"><a href="#枚举" class="header-anchor">#</a> 枚举</h2> <p>要标识enum，我们必须使用值数组手动设置enum属性@ApiProperty。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Admin'</span><span class="token punctuation">,</span> <span class="token string">'Moderator'</span><span class="token punctuation">,</span> <span class="token string">'User'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
role<span class="token operator">:</span> UserRole<span class="token punctuation">;</span>
</code></pre></div><p>或者，如下定义一个实际的TypeScript枚举：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">enum</span> UserRole <span class="token punctuation">{</span>
  Admin <span class="token operator">=</span> <span class="token string">'Admin'</span><span class="token punctuation">,</span>
  Moderator <span class="token operator">=</span> <span class="token string">'Moderator'</span><span class="token punctuation">,</span>
  User <span class="token operator">=</span> <span class="token string">'User'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后，您可以将枚举直接与@Query()参数decorator结合使用@ApiQuery()。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'role'</span><span class="token punctuation">,</span> <span class="token keyword">enum</span><span class="token operator">:</span> UserRole <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">filterByRole</span><span class="token punctuation">(</span>@<span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">'role'</span><span class="token punctuation">)</span> role<span class="token operator">:</span> UserRole <span class="token operator">=</span> UserRole<span class="token punctuation">.</span>User<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>随着isArray设置为真，则enum可以选择作为一个多选：</p> <h2 id="枚举架构"><a href="#枚举架构" class="header-anchor">#</a> 枚举架构</h2> <p>默认情况下，该enum物业将增加的原始定义枚举的parameter。</p> <div class="language-rs extra-class"><pre class="language-text"><code>CatDetail:
  type: 'object'
  properties:
    ...
    - breed:
        type: 'string'
        enum:
          - Persian
          - Tabby
          - Siamese
</code></pre></div><p>上面的规范在大多数情况下都可以正常工作。但是，如果您使用的是一种将规范作为输入并生成客户端代码的工具，则可能会遇到包含重复代码的生成代码的问题enums。考虑以下代码片段：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// generated client-side code</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatDetail</span> <span class="token punctuation">{</span>
   breed<span class="token operator">:</span> CatDetailEnum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatInformation</span> <span class="token punctuation">{</span>
  breed<span class="token operator">:</span> CatInformationEnum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">enum</span> CatDetailEnum <span class="token punctuation">{</span>
  Persian <span class="token operator">=</span> <span class="token string">'Persian'</span><span class="token punctuation">,</span>
  Tabby <span class="token operator">=</span> <span class="token string">'Tabby'</span><span class="token punctuation">,</span>
  Siamese <span class="token operator">=</span> <span class="token string">'Siamese'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">enum</span> CatInformationEnum <span class="token punctuation">{</span>
  Persian <span class="token operator">=</span> <span class="token string">'Persian'</span><span class="token punctuation">,</span>
  Tabby <span class="token operator">=</span> <span class="token string">'Tabby'</span><span class="token punctuation">,</span>
  Siamese <span class="token operator">=</span> <span class="token string">'Siamese'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
上面的代码片段是使用称为NSwag的工具生成的。</p></div> <p>您可以看到，现在有两个enums完全相同。要解决此问题，您可以在装饰器中将enumNamenext 传递给enumproperty。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatDetail</span> <span class="token punctuation">{</span>
   @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">enum</span><span class="token operator">:</span> CatBreed<span class="token punctuation">,</span> enumName<span class="token operator">:</span> <span class="token string">'CatBreed'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
   breed<span class="token operator">:</span> CatBreed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>enumName能够变成自己的东西，这nestjs/swagger反过来又可以重用。该规范将如下所示：CatBreedschemaCatBreed</p> <p>:::
CatDetail:
type: 'object'
properties:
...
- breed:
schema:
$ref: '#/components/schemas/CatBreed'
CatBreed:
type: string
enum:
- Persian
- Tabby
- Siamese
:::</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
任何作为属性的装饰器也enum将采用enumName。</p></div> <h2 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h2> <p>当属性是数组时，我们必须手动指示数组类型，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
names<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
考虑使用Swagger插件（请参阅“ 插件”部分），它将自动检测阵列。</p></div> <p>将类型包括为数组的第一个元素（如上所示），或将isArray属性设置为true。</p> <h2 id="依赖循环"><a href="#依赖循环" class="header-anchor">#</a> 依赖循环</h2> <p>当类之间具有循环依赖关系时，请使用惰性函数来提供SwaggerModule类型信息：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Node <span class="token punctuation">}</span><span class="token punctuation">)</span>
node<span class="token operator">:</span> Node<span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
考虑使用Swagger插件（请参阅“ 插件”部分），它将自动检测循环依赖关系。</p></div> <h2 id="泛型和接口"><a href="#泛型和接口" class="header-anchor">#</a> 泛型和接口</h2> <p>由于TypeScript不存储有关泛型或接口的元数据，因此在DTO中使用它们时，SwaggerModule可能无法在运行时正确生成模型定义。例如，以下代码将不会被Swagger模块正确检查：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">createBulk</span><span class="token punctuation">(</span>@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> usersDto<span class="token operator">:</span> CreateUserDto<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>为了克服此限制，可以显式设置类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">[</span>CreateUserDto<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">createBulk</span><span class="token punctuation">(</span>@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> usersDto<span class="token operator">:</span> CreateUserDto<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="原始定义"><a href="#原始定义" class="header-anchor">#</a> 原始定义</h2> <p>在某些特定情况下（例如，深度嵌套的数组，矩阵），您可能需要手动描述类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
  items<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
    items<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'number'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
coords<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>同样，为了在控制器类中手动定义输入/输出内容，请使用schema属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  schema<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
    items<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
      items<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'number'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> coords<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="额外的模型"><a href="#额外的模型" class="header-anchor">#</a> 额外的模型</h2> <p>为了定义其他应由Swagger模块检查的模型，请使用@ApiExtraModels()装饰器：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiExtraModels</span><span class="token punctuation">(</span>ExtraModel<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>然后，您可以使用来获得$ref模型的参考（）getSchemaPath(ExtraModel)：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token string">'application/vnd.api+json'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   schema<span class="token operator">:</span> <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>ExtraModel<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre></div><h2 id="oneof，anyof，allof"><a href="#oneof，anyof，allof" class="header-anchor">#</a> oneOf，anyOf，allOf</h2> <p>为了结合的模式，您可以使用oneOf，anyOf或allOf关键字（阅读更多）。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  oneOf<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Cat<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Dog<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
pet<span class="token operator">:</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">;</span>
</code></pre></div><p>如果要定义多态数组（即，其成员跨越多个架构的数组），则应使用原始定义（请参见上文）来手动定义类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> Pet <span class="token operator">=</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">;</span>

@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
  items<span class="token operator">:</span> <span class="token punctuation">{</span>
    oneOf<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Cat<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Dog<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
pets<span class="token operator">:</span> Pet<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> Pet <span class="token operator">=</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">;</span>

@<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
  items<span class="token operator">:</span> <span class="token punctuation">{</span>
    oneOf<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Cat<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>Dog<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
pets<span class="token operator">:</span> Pet<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>必须使用装饰器（在类级别）将两者Cat和Dog都定义为额外的模型@ApiExtraModels()。</p> <h2 id="多种规格"><a href="#多种规格" class="header-anchor">#</a> 多种规格</h2> <p>在SwaggerModule提供了一种支持多种规格。换句话说，您可以在不同的端点上使用不同的UI提供不同的文档。</p> <p>为了支持多种规格，您的应用程序必须使用模块化方法编写。该createDocument()方法采用第三个参数，extraOptions该参数是具有属性的对象include。该include属性的值是一个模块数组。</p> <p>您可以设置多种规格支持，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SwaggerModule<span class="token punctuation">,</span> DocumentBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/swagger'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app.module'</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * createDocument(application, configurationOptions, extraOptions);
   *
   * createDocument method takes in an optional 3rd argument &quot;extraOptions&quot;
   * which is an object with &quot;include&quot; property where you can pass an Array
   * of Modules that you want to include in that Swagger Specification
   * E.g: CatsModule and DogsModule will have two separate Swagger Specifications which
   * will be exposed on two different SwaggerUI with two different endpoints.
   */</span>

  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">'Cats example'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">'The cats API description'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setVersion</span><span class="token punctuation">(</span><span class="token string">'1.0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addTag</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> catDocument <span class="token operator">=</span> SwaggerModule<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    include<span class="token operator">:</span> <span class="token punctuation">[</span>CatsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  SwaggerModule<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token string">'api/cats'</span><span class="token punctuation">,</span> app<span class="token punctuation">,</span> catDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> secondOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">'Dogs example'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">'The dogs API description'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setVersion</span><span class="token punctuation">(</span><span class="token string">'1.0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addTag</span><span class="token punctuation">(</span><span class="token string">'dogs'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> dogDocument <span class="token operator">=</span> SwaggerModule<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> secondOptions<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    include<span class="token operator">:</span> <span class="token punctuation">[</span>DogsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  SwaggerModule<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token string">'api/dogs'</span><span class="token punctuation">,</span> app<span class="token punctuation">,</span> dogDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>现在，您可以使用以下命令启动服务器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run start
</code></pre></div><p>导航至http://localhost:3000/api/cats猫的Swagger UI：</p> <p>https://docs.nestjs.com/assets/swagger-cats.png</p> <p>反过来，http://localhost:3000/api/dogs将为狗公开Swagger UI：</p> <p>https://docs.nestjs.com/assets/swagger-dogs.png</p> <h2 id="标签"><a href="#标签" class="header-anchor">#</a> 标签</h2> <p>要将控制器附加到特定标签，请使用@ApiTags(...tags)装饰器。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiTags</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="标头"><a href="#标头" class="header-anchor">#</a> 标头</h2> <p>要定义期望作为请求一部分的自定义标头，请使用@ApiHeader()。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiHeader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'X-MyHeader'</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">'Custom header'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="回应"><a href="#回应" class="header-anchor">#</a> 回应</h2> <p>要定义自定义HTTP响应，我们使用@ApiResponse()装饰器。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">ApiResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
@<span class="token function">ApiResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">'Forbidden.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Nest提供了一组从装饰器继承的速记API响应装饰@ApiResponse器：</p> <ul><li>@ApiOkResponse()</li> <li>@ApiCreatedResponse()</li> <li>@ApiBadRequestResponse()</li> <li>@ApiUnauthorizedResponse()</li> <li>@ApiNotFoundResponse()</li> <li>@ApiForbiddenResponse()</li> <li>@ApiMethodNotAllowedResponse()</li> <li>@ApiNotAcceptableResponse()</li> <li>@ApiRequestTimeoutResponse()</li> <li>@ApiConflictResponse()</li> <li>@ApiGoneResponse()</li> <li>@ApiPayloadTooLargeResponse()</li> <li>@ApiUnsupportedMediaTypeResponse()</li> <li>@ApiUnprocessableEntityResponse()</li> <li>@ApiInternalServerErrorResponse()</li> <li>@ApiNotImplementedResponse()</li> <li>@ApiBadGatewayResponse()</li> <li>@ApiServiceUnavailableResponse()</li> <li>@ApiGatewayTimeoutResponse()</li> <li>@ApiDefaultResponse()</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">ApiCreatedResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
@<span class="token function">ApiForbiddenResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token string">'Forbidden.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要为请求指定返回模型，我们必须创建一个类，并用@ApiProperty()装饰器注释所有属性。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后，Cat必须将模型与type响应装饰器的属性结合使用。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiTags</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  @<span class="token function">ApiCreatedResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">,</span>
    <span class="token keyword">type</span><span class="token operator">:</span> Cat<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span>@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Cat<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>让我们打开浏览器并验证生成的Cat模型：</p> <p>https://docs.nestjs.com/assets/swagger-response-type.png</p> <h2 id="全局设置"><a href="#全局设置" class="header-anchor">#</a> 全局设置</h2> <p>要忽略通过设置的路由的全局前缀setGlobalPrefix()，请使用ignoreGlobalPrefix：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> document <span class="token operator">=</span> SwaggerModule<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  ignoreGlobalPrefix<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h2> <p>若要定义对特定操作应使用的安全性机制，请使用@ApiSecurity()装饰器。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiSecurity</span><span class="token punctuation">(</span><span class="token string">'basic'</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>在运行应用程序之前，请记住使用以下命令将安全性定义添加到基本文档中DocumentBuilder：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addSecurity</span><span class="token punctuation">(</span><span class="token string">'basic'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'http'</span><span class="token punctuation">,</span>
  scheme<span class="token operator">:</span> <span class="token string">'basic'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>一些最流行的身份验证技术是预定义的（例如basic和bearer），因此您不必如上所述手动定义安全性机制。</p> <h2 id="基本身份验证"><a href="#基本身份验证" class="header-anchor">#</a> 基本身份验证</h2> <p>要启用基本身份验证，请使用@ApiBasicAuth()。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiBasicAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>在运行应用程序之前，请记住使用以下命令将安全性定义添加到基本文档中DocumentBuilder：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addBasicAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="承载认证"><a href="#承载认证" class="header-anchor">#</a> 承载认证</h2> <p>要启用承载身份验证，请使用@ApiBearerAuth()。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiBearerAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>在运行应用程序之前，请记住使用以下命令将安全性定义添加到基本文档中DocumentBuilder：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addBearerAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="oauth2身份验证"><a href="#oauth2身份验证" class="header-anchor">#</a> OAuth2身份验证</h2> <p>要启用OAuth2，请使用@ApiOAuth2()。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiOAuth2</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'pets:write'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>在运行应用程序之前，请记住使用以下命令将安全性定义添加到基本文档中DocumentBuilder：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addOAuth2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="文件上传"><a href="#文件上传" class="header-anchor">#</a> 文件上传</h2> <p>您可以使用@ApiBody装饰器和启用针对特定方法的文件上传@ApiConsumes()。这是使用文件上传技术的完整示例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">UseInterceptors</span><span class="token punctuation">(</span><span class="token function">FileInterceptor</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
@<span class="token function">ApiConsumes</span><span class="token punctuation">(</span><span class="token string">'multipart/form-data'</span><span class="token punctuation">)</span>
@<span class="token function">ApiBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  description<span class="token operator">:</span> <span class="token string">'List of cats'</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span><span class="token operator">:</span> FileUploadDto<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">UploadedFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>其中FileUploadDto的定义如下：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">FileUploadDto</span> <span class="token punctuation">{</span>
  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> format<span class="token operator">:</span> <span class="token string">'binary'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  file<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="扩展"><a href="#扩展" class="header-anchor">#</a> 扩展</h2> <p>要将扩展添加到请求，请使用@ApiExtension()装饰器。扩展名必须以开头x-。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">ApiExtension</span><span class="token punctuation">(</span><span class="token string">'x-foo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> hello<span class="token operator">:</span> <span class="token string">'world'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="装饰"><a href="#装饰" class="header-anchor">#</a> 装饰</h2> <p>所有可用的OpenAPI装饰器都有一个Api前缀，以区别于核心装饰器。以下是导出的装饰器的完整列表，以及装饰器可应用级别的指定。</p> <ul><li>@ApiOperation()	方法</li> <li>@ApiResponse()	方法/控制器</li> <li>@ApiProduces()	方法/控制器</li> <li>@ApiConsumes()	方法/控制器</li> <li>@ApiBearerAuth()	方法/控制器</li> <li>@ApiOAuth2()	方法/控制器</li> <li>@ApiBasicAuth()	方法/控制器</li> <li>@ApiSecurity()	方法/控制器</li> <li>@ApiExtraModels()	方法/控制器</li> <li>@ApiBody()	方法</li> <li>@ApiParam()	方法</li> <li>@ApiQuery()	方法</li> <li>@ApiHeader()	方法/控制器</li> <li>@ApiExcludeEndpoint()	方法</li> <li>@ApiTags()	方法/控制器</li> <li>@ApiProperty()	模型</li> <li>@ApiPropertyOptional()	模型</li> <li>@ApiHideProperty()	模型</li> <li>@ApiExtension()	方法</li></ul> <h2 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h2> <p>TypeScript的元数据反映系统具有多个限制，这些限制使得例如确定类包含哪些属性或识别给定属性是可选属性还是必需属性成为不可能。但是，其中一些约束可以在编译时解决。Nest提供了可增强TypeScript编译过程以减少所需样板代码量的插件。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示
此插件是opt-in。如果愿意，可以手动声明所有装饰器，也可以只声明需要的特定装饰器。</p></div> <p>Swagger插件将自动：</p> <p>使用@ApiProperty除非@ApiHideProperty使用注释所有DTO属性
required根据问号设置属性（例如name?: string将设置required: false）
根据类型设置typeor enum属性（也支持数组）
default根据分配的默认值设置属性
根据class-validator装饰器设置一些验证规则（如果classValidatorShim设置为true）
向状态正确的每个端点添加响应装饰器和type（响应模型）
请注意，您的文件名必须具有以下后缀之一：（['.dto.ts', '.entity.ts']例如，create-user.dto.ts），以便被插件分析。</p> <p>以前，如果您想通过Swagger UI提供交互体验，则必须重复很多代码以使程序包知道应如何在规范中声明模型/组件。例如，您可以定义一个简单的CreateUserDto类，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateUserDto</span> <span class="token punctuation">{</span>
  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  password<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">enum</span><span class="token operator">:</span> RoleEnum<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> isArray<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  roles<span class="token operator">:</span> RoleEnum<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  @<span class="token function">ApiProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> required<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  isEnabled<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>尽管对于中型项目来说这并不是什么大问题，但是一旦您拥有大量的类，它就会变得冗长而笨拙。</p> <p>现在，在启用Swagger插件的情况下，可以简单地声明上述类定义：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateUserDto</span> <span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  password<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  roles<span class="token operator">:</span> RoleEnum<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  isEnabled<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>该插件根据抽象语法树动态添加适当的装饰器。因此，您不再需要与@ApiProperty分散在整个项目中的装饰者作斗争。</p></div> <p>为了启用该插件，只需打开nest-cli.json（如果使用Nest CLI）并添加以下plugins配置：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;collection&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@nestjs/schematics&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@nestjs/swagger/plugin&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>您可以使用该options属性来自定义插件的行为。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@nestjs/swagger/plugin&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;classValidatorShim&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>该options属性必须满足以下接口：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PluginOptions</span> <span class="token punctuation">{</span>
  dtoFileNameSuffix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  controllerFileNameSuffix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  classValidatorShim<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><table><thead><tr><th style="text-align:left;">选项</th> <th style="text-align:left;">默认</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">dtoFileNameSuffix</td> <td style="text-align:left;">['.dto.ts', '.entity.ts']</td> <td style="text-align:left;">DTO（数据传输对象）文件后缀</td></tr> <tr><td style="text-align:left;">controllerFileNameSuffix</td> <td style="text-align:left;">.controller.ts</td> <td style="text-align:left;">控制器文件后缀</td></tr> <tr><td style="text-align:left;">classValidatorShim</td> <td style="text-align:left;">true</td> <td style="text-align:left;">如果设置为true，则模块将重用class-validator验证装饰器（例如，@Max(10)将添加max: 10到架构定义中）</td></tr></tbody></table> <p>如果您不使用CLI，而是使用自定义webpack配置，则可以将此插件与ts-loader：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function-variable function">getCustomTransformers</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">program<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  before<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'@nestjs/swagger/plugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> program<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><p>迁移到4.0 ＃
如果您当前正在使用@nestjs/swagger@3.*，请注意4.0版中的以下重大更改/ API更改。</p> <p>以下装饰器已更改/重命名：</p> <ul><li>@ApiModelProperty 就是现在 @ApiProperty</li> <li>@ApiModelPropertyOptional 就是现在 @ApiPropertyOptional</li> <li>@ApiResponseModelProperty 就是现在 @ApiResponseProperty</li> <li>@ApiImplicitQuery 就是现在 @ApiQuery</li> <li>@ApiImplicitParam 就是现在 @ApiParam</li> <li>@ApiImplicitBody 就是现在 @ApiBody</li> <li>@ApiImplicitHeader 就是现在 @ApiHeader</li> <li>@ApiOperation({ title: 'test' }) 就是现在@ApiOperation({ summary: 'test' })</li> <li>@ApiUseTags 就是现在 @ApiTags</li></ul> <p>DocumentBuilder 重大更改（更新的方法签名）：</p> <ul><li><p>addTag</p></li> <li><p>addBearerAuth</p></li> <li><p>addOAuth2</p></li> <li><p>setContactEmail 就是现在 setContact</p></li> <li><p>setHost 已被删除</p></li> <li><p>setSchemes 已被删除
添加了以下方法：</p></li> <li><p>addServer</p></li> <li><p>addApiKey</p></li> <li><p>addBasicAuth</p></li> <li><p>addSecurity</p></li> <li><p>addSecurityRequirements</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/nestjs/office-docs/09-recipes/03-sequelize.html" class="prev">SQL（序列化）</a></span> <span class="next"><a href="/framework/nestjs/office-docs/09-recipes/05-CQRS.html">CQRS</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.12ca0aa8.js" defer></script><script src="/assets/js/2.74bffc86.js" defer></script><script src="/assets/js/108.d0fceeff.js" defer></script>
  </body>
</html>
